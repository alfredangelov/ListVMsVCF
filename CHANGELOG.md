# VM Listing Toolkit - Changelog

## Version 2.1.0 - August 19, 2025

### üöÄ Major New Features

#### **Direct ESXi Host Support**

- ‚úÖ **New Script**: `List-VMs-esxi.ps1` for direct ESXi host VM listing
- ‚úÖ **Standalone ESXi Compatibility**: Works with ESXi hosts not managed by vCenter
- ‚úÖ **ESXi-Specific Functions**: `Get-VMsFromESXiHost` bypasses vCenter folder concepts
- ‚úÖ **Unified Configuration**: Uses same `Configuration.psd1` format as vCenter version
- ‚úÖ **Distinguished Filenames**: `VMList_ESXi_hostname_YYYYMMDD_HHMMSS.xlsx` format

#### **Enhanced SSL Certificate Handling**

- ‚úÖ **Configurable SSL Support**: `IgnoreSSLCertificates` and `NetworkHasSSLInspection` settings
- ‚úÖ **Enterprise Network Compatibility**: Support for networks with SSL inspection (Zscaler, etc.)
- ‚úÖ **Multi-TLS Protocol Support**: Automatic TLS 1.0/1.1/1.2 compatibility for ESXi hosts
- ‚úÖ **Certificate Validation Bypass**: Configurable certificate validation for self-signed certificates
- ‚úÖ **Network Appliance Handling**: Enhanced connectivity through corporate security appliances

#### **VCF.PowerCLI Optional Module Integration**

- ‚úÖ **Smart Module Detection**: `Test-OptionalModule` function checks for VCF.PowerCLI availability
- ‚úÖ **User-Prompted Installation**: `Install-OptionalModule` with user consent for optional modules
- ‚úÖ **Graceful Degradation**: Works perfectly without VCF.PowerCLI for standard vSphere environments
- ‚úÖ **Framework for Future Modules**: Extensible pattern for additional optional modules

#### **Server-Aware File Naming**

- ‚úÖ **Hostname Extraction**: Automatic server hostname detection from connection
- ‚úÖ **Clean Filename Generation**: Sanitized hostnames for valid Windows filenames
- ‚úÖ **Multi-Environment Identification**: Easy distinction between vCenter and ESXi exports
- ‚úÖ **VCF Management Domain Support**: Clear identification of VCF vCenter instances

### üîß Technical Enhancements

#### **SSL/TLS Compatibility**

- ‚úÖ **ServicePointManager Configuration**: Automatic .NET SSL protocol configuration
- ‚úÖ **Certificate Validation Callbacks**: Custom certificate validation for enterprise networks
- ‚úÖ **PowerCLI SSL Integration**: Enhanced PowerCLI InvalidCertificateAction handling
- ‚úÖ **Network Environment Detection**: Configurable handling for different network security postures

#### **Connection Resilience**

- ‚úÖ **Enhanced Error Handling**: Detailed SSL connection error diagnostics
- ‚úÖ **Network Troubleshooting Guidance**: Built-in guidance for common SSL issues
- ‚úÖ **Multi-Protocol Fallback**: Automatic protocol negotiation for older ESXi versions
- ‚úÖ **Corporate Network Support**: Specific handling for enterprise security appliances

#### **Code Quality Improvements**

- ‚úÖ **PSScriptAnalyzer Compliance**: Full lint compliance with 0 critical errors
- ‚úÖ **Enhanced Error Logging**: Improved catch block handling with proper error verbosity
- ‚úÖ **UTF8BOM Encoding**: Proper Unicode file encoding for international compatibility
- ‚úÖ **Trailing Whitespace Cleanup**: Clean code formatting throughout all scripts

### üìä New Configuration Options

#### **SSL Configuration**

```powershell
# SSL Certificate handling (useful for ESXi hosts with self-signed certificates)
IgnoreSSLCertificates = $true                           # Set to $false for production vCenter with valid certificates

# Network environment settings
# Set to $true if running from networks with SSL inspection (Zscaler, etc.)
NetworkHasSSLInspection = $true                         # Enables additional SSL compatibility measures
```

#### **Enhanced Connection Parameters**

- ‚úÖ **SSL Certificate Control**: Fine-grained SSL certificate validation control
- ‚úÖ **Network Environment Awareness**: Specific settings for SSL inspection environments
- ‚úÖ **Backward Compatibility**: All existing configurations continue to work unchanged

### üåê Network Compatibility

#### **Enterprise Network Support**

- ‚úÖ **Zscaler Compatibility**: Specific handling for Zscaler SSL inspection
- ‚úÖ **BlueCoat Support**: Compatible with BlueCoat proxy appliances
- ‚úÖ **Palo Alto Integration**: Works through Palo Alto firewalls with SSL decryption
- ‚úÖ **Corporate VPN**: Enhanced compatibility with various VPN solutions

#### **Direct ESXi Access**

- ‚úÖ **Self-Signed Certificate Handling**: Automatic handling of ESXi self-signed certificates
- ‚úÖ **Older TLS Protocol Support**: Compatibility with older ESXi versions using TLS 1.0/1.1
- ‚úÖ **Lab Environment Optimized**: Perfect for development and testing ESXi hosts
- ‚úÖ **Standalone Host Support**: Works with ESXi hosts not managed by vCenter

### üìö Documentation Updates

#### **Comprehensive SSL Documentation**

- ‚úÖ **Network Compatibility Guide**: Detailed section on SSL handling and network environments
- ‚úÖ **Enterprise Network Scenarios**: Specific guidance for corporate network challenges
- ‚úÖ **Troubleshooting SSL Issues**: Step-by-step SSL connection troubleshooting
- ‚úÖ **ESXi Direct Connection Guide**: Complete documentation for ESXi host connections

#### **Enhanced Usage Examples**

- ‚úÖ **ESXi Script Examples**: Complete usage examples for `List-VMs-esxi.ps1`
- ‚úÖ **Network Configuration Examples**: Real-world network configuration scenarios
- ‚úÖ **Multi-Environment Setup**: Documentation for managing multiple environments
- ‚úÖ **SSL Troubleshooting Workflows**: Diagnostic procedures for SSL issues

### üîÑ Migration Notes

#### **From Version 2.0.0**

1. **Update Configuration**: Add SSL settings to your `Configuration.psd1`:

   ```powershell
   IgnoreSSLCertificates = $true
   NetworkHasSSLInspection = $true  # Set based on your network environment
   ```

2. **Test ESXi Support**: Try the new ESXi script if you have standalone ESXi hosts:

   ```powershell
   .\scripts\List-VMs-esxi.ps1
   ```

3. **Verify SSL Handling**: Test connections through your corporate network with enhanced SSL support

#### **Configuration Backward Compatibility**

- ‚úÖ **No Breaking Changes**: All existing configurations continue to work unchanged
- ‚úÖ **New Settings Optional**: SSL settings have sensible defaults if not specified
- ‚úÖ **Graceful Degradation**: Scripts work without new settings, with appropriate defaults

### üß™ Testing and Validation

#### **Comprehensive Testing Results**

- ‚úÖ **ESXi Host Testing**: Successfully tested with ESXi 6.7 hosts (37 VMs processed)
- ‚úÖ **SSL Inspection Testing**: Validated behavior through Zscaler network environments
- ‚úÖ **Multi-Protocol Testing**: Confirmed TLS 1.0/1.1/1.2 compatibility
- ‚úÖ **Code Quality Validation**: 0 critical lint errors, 52 acceptable Write-Host warnings for UI scripts

#### **Real-World Validation**

- ‚úÖ **Corporate Network Testing**: Validated through enterprise networks with SSL inspection
- ‚úÖ **Internal Network Validation**: Confirmed functionality from internal network segments
- ‚úÖ **Multi-Environment Testing**: Tested across development, staging, and production environments
- ‚úÖ **VCF Environment Testing**: Validated compatibility with VMware Cloud Foundation deployments

## Version 2.0.0 - August 1, 2025

### üöÄ Major Enhancements

#### **Configuration-Driven Architecture**

- ‚úÖ **Centralized Configuration**: All settings now managed through `Configuration.psd1`
- ‚úÖ **Dynamic Credential Management**: `preferredVault` and `CredentialName` settings from config
- ‚úÖ **Environment-Specific Configs**: Support for multiple configuration files

#### **Automatic Environment Setup**

- ‚úÖ **One-Command Initialization**: `Initialize-Environment.ps1` sets up everything automatically
- ‚úÖ **Smart Vault Creation**: Creates SecretStore vaults only when needed
- ‚úÖ **Intelligent Vault Selection**: Prioritizes existing `VCenterVault` to avoid conflicts
- ‚úÖ **Credential Auto-Storage**: Prompts once, stores securely, reuses automatically

#### **Enhanced Credential Management**

- ‚úÖ **Vault Auto-Creation**: Creates configured vault if it doesn't exist
- ‚úÖ **SecretStore Configuration**: Automatically configures SecretStore with sensible defaults
- ‚úÖ **Vault Functionality Testing**: Validates vault operation after creation
- ‚úÖ **Comprehensive Error Handling**: Clear guidance when manual intervention needed

#### **Robust Module Architecture**

- ‚úÖ **Enhanced EnvironmentValidator**: Added credential management functions
- ‚úÖ **Smart vSphereConnector**: Automatic credential retrieval with fallback prompting
- ‚úÖ **Optional Module Support**: Framework for optional modules with user prompts
- ‚úÖ **VCF.PowerCLI Integration**: Optional VMware Cloud Foundation support

#### **VMware Cloud Foundation (VCF) Support**

- ‚úÖ **Native VCF Compatibility**: Works with VCF environments without code changes
- ‚úÖ **Optional VCF.PowerCLI Module**: Enhanced VCF features available on demand
- ‚úÖ **VCF Management Domain Support**: Can target vCenter instances within VCF
- ‚úÖ **Workload Domain VM Discovery**: Retrieves VMs from any VCF workload domain
- ‚úÖ **Professional ExcelExporter**: Dual-header format with metadata sheets

#### **Improved User Experience**

- ‚úÖ **Better Progress Indicators**: Clear status messages and progress display
- ‚úÖ **Enhanced Error Messages**: Detailed troubleshooting guidance
- ‚úÖ **Comprehensive Documentation**: Updated README with examples and guides
- ‚úÖ **Configuration Templates**: Detailed example configuration with inline help
- ‚úÖ **Intelligent File Naming**: Excel files include server hostname in filename

#### **Enhanced Excel Export**

- ‚úÖ **Server-Aware Filenames**: Format `VMList_hostname_YYYYMMDD_HHMMSS.xlsx`
- ‚úÖ **Multi-Environment Support**: Easy identification of source vCenter environment
- ‚úÖ **VCF-Compatible Naming**: Works with VCF management and workload domain servers

#### **ESXi Direct Connection Support**

- ‚úÖ **ESXi Host VM Listing**: New `List-VMs-esxi.ps1` for direct ESXi host connections
- ‚úÖ **Standalone ESXi Support**: Works with ESXi hosts not managed by vCenter
- ‚úÖ **Same Configuration Format**: Uses identical config file structure as vCenter version
- ‚úÖ **ESXi-Specific Filename Format**: `VMList_ESXi_hostname_YYYYMMDD_HHMMSS.xlsx`
- ‚úÖ **Unified Credential Management**: Same vault and credential system for both scripts

#### **Utility Script Enhancements**

- ‚úÖ **Quick Credential Updates**: New `Quick-CredentialUpdate.ps1` for fast credential changes
- ‚úÖ **Simplified Workflow**: Minimal prompts for quick credential rotation

### üîß Technical Improvements

#### **Security Enhancements**

- ‚úÖ **Encrypted Credential Storage**: Uses Windows DPAPI for secure storage
- ‚úÖ **User-Scoped Credentials**: Credentials isolated per user account
- ‚úÖ **No Plain-Text Storage**: No passwords in configuration files
- ‚úÖ **Secure Memory Handling**: Proper credential object cleanup

#### **Reliability Improvements**

- ‚úÖ **Connection Auto-Retry**: Robust connection handling
- ‚úÖ **Proper Cleanup**: Ensures vSphere connections are always closed
- ‚úÖ **Module Import Safety**: Handles module loading conflicts gracefully
- ‚úÖ **Path Resolution**: Fixed module path resolution in vSphereConnector

#### **Performance Optimizations**

- ‚úÖ **Efficient VM Processing**: Progress indicators for large VM sets
- ‚úÖ **Memory Management**: Better handling of large datasets
- ‚úÖ **Background Processing**: Non-blocking operations where possible

### üìä New Features

#### **Advanced Utilities**

- ‚úÖ **Environment Status**: Comprehensive status checking
- ‚úÖ **Connection Testing**: Dedicated connection validation
- ‚úÖ **Folder Validation**: Smart folder existence checking
- ‚úÖ **Credential Testing**: Validates stored credential accessibility

#### **Enhanced Excel Output**

- ‚úÖ **Professional Formatting**: Dual-header system with metadata
- ‚úÖ **Timestamp-Based Naming**: Auto-generated timestamped filenames
- ‚úÖ **Metadata Sheets**: Export details and configuration summary
- ‚úÖ **NULL Value Handling**: Consistent display of missing data

#### **Configuration Flexibility**

- ‚úÖ **Multiple VM Properties**: Extensive list of exportable properties
- ‚úÖ **Custom Output Paths**: Configurable output directory
- ‚úÖ **Dry Run Mode**: Safe testing without file creation
- ‚úÖ **Future Enhancement Points**: Framework for filtering and customization

### üõ†Ô∏è Developer Improvements

#### **Code Quality**

- ‚úÖ **Modular Architecture**: Clean separation of concerns
- ‚úÖ **Error Handling**: Comprehensive try-catch blocks throughout
- ‚úÖ **Logging**: Verbose output for troubleshooting
- ‚úÖ **Documentation**: Inline help for all functions

#### **Testing Support**

- ‚úÖ **Test Data Sources**: "Discovered virtual machine" folder for testing
- ‚úÖ **Validation Scripts**: Comprehensive diagnostic utilities
- ‚úÖ **Debug Mode**: Verbose output for troubleshooting
- ‚úÖ **Mock Data**: Dry run mode for safe testing

### üìö Enhanced Documentation (v2.0)

#### **Comprehensive README**

- ‚úÖ **Quick Start Guide**: Step-by-step setup instructions
- ‚úÖ **Architecture Overview**: Detailed module descriptions
- ‚úÖ **Troubleshooting Guide**: Common issues and solutions
- ‚úÖ **Advanced Configuration**: Customization examples

#### **Configuration Documentation**

- ‚úÖ **Example Configuration**: Comprehensive template with comments
- ‚úÖ **Inline Help**: Detailed explanations for each setting
- ‚úÖ **Common Scenarios**: Real-world configuration examples
- ‚úÖ **Best Practices**: Security and performance recommendations

### üîÑ Migration Guide

#### **From Version 1.x**

1. **Backup Current Config**: `Copy-Item Configuration.psd1 Configuration.backup.psd1`
2. **Add New Settings**: Update config with `preferredVault` and `CredentialName`
3. **Run Initialization**: `.\scripts\Initialize-Environment.ps1`
4. **Test Functionality**: `.\scripts\Toolkit-Utilities.ps1 -Action Status`

#### **New Installation**

1. **Configure Settings**: Copy and edit `shared\Configuration.example.psd1` to `shared\Configuration.psd1`
2. **Initialize Environment**: `.\scripts\Initialize-Environment.ps1`
3. **Test Connection**: `.\scripts\Toolkit-Utilities.ps1 -Action TestConnection`
4. **Run VM Listing**: `.\scripts\List-VMs.ps1`

## Version 1.0.0 - July 30, 2025

### Initial Release

- ‚úÖ Basic VM listing functionality
- ‚úÖ Excel export capability
- ‚úÖ vSphere connectivity
- ‚úÖ Module-based architecture
- ‚úÖ Configuration file support

---

## Future Roadmap

### Planned Enhancements

- üîÆ **Multi-vCenter Support**: Aggregate data from multiple vCenters
- üîÆ **Advanced Filtering**: VM filtering by various criteria
- üîÆ **Performance Metrics**: Include VM performance data
- üîÆ **Scheduling Support**: Built-in task scheduler integration
- üîÆ **Report Templates**: Customizable Excel templates
- üîÆ **Export Formats**: CSV, JSON, XML export options
- üîÆ **API Integration**: REST API for programmatic access
- üîÆ **GUI Interface**: PowerShell GUI for non-technical users

### Community Contributions

- üìù **Documentation Improvements**: Ongoing documentation updates
- üß™ **Testing Framework**: Automated testing infrastructure
- üîß **Additional Modules**: Extended functionality modules
- üìä **Report Templates**: Community-contributed templates

---

**Toolkit Version**: 2.0.0  
**Release Date**: August 1, 2025  
**PowerShell Compatibility**: 5.1+ (7.0+ recommended)  

**Author**: Alfred Angelov
